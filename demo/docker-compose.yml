version: "2"
services:
  postgrescompose:
    image: "postgres:9.5"
    container_name: "postgrescompose"
    hostname: "postgrescompose"
    ports:
      - "5432:5432"
    command: "postgres"
  foulkonworkercompose:
    image: "tecsisa/foulkon:v0.2.0"
    container_name: "foulkonworkercompose"
    hostname: "foulkonworkercompose"
    environment:
      - FOULKON_WORKER_HOST=foulkonworkercompose
      - FOULKON_WORKER_PORT=8000
      - FOULKON_ADMIN_USER=admin
      - FOULKON_ADMIN_PASS=admin
      - FOULKON_WORKER_LOG_TYPE=default
      - FOULKON_WORKER_LOG_LEVEL=info
      - FOULKON_DB=postgres
      - FOULKON_DB_POSTGRES_DS=postgres://postgres:password@postgrescompose:5432/postgres?sslmode=disable
      - FOULKON_DB_POSTGRES_IDLECONNS=10
      - FOULKON_DB_POSTGRES_MAXCONNS=20
      - FOULKON_DB_POSTGRES_CONNTTL=300
      - FOULKON_AUTH_TYPE=oidc
      - FOULKON_AUTH_ISSUER=https://accounts.google.com
      - FOULKON_AUTH_CLIENTID=google-client-identity
    ports:
      - "8000:8000"
    command: "worker"
    depends_on:
      - postgrescompose
